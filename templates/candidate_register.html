{% extends "base.html" %}

{% block title %}Register Candidates{% endblock %}

{% block content %}
    <h2 class="page-title">Candidate Management</h2>
    
    {% if db_message %}
    <div class="alert {% if db_error %}alert-danger{% else %}alert-success{% endif %}">
        <i class="fas {% if db_error %}fa-exclamation-circle{% else %}fa-check-circle{% endif %}"></i> 
        {{ db_message }}
    </div>
    {% endif %}
    
    <div class="card">
        <h2><i class="fas fa-database"></i> Oracle Database Connection</h2>
        <div class="form-group">
            <p>To connect to Oracle Database from command line:</p>
            <pre class="code-block">
sqlplus username/password@//hostname:port/service_name
# or
sqlplus username/password@hostname:port/service_name
# or 
sqlplus username/password@TNS_ALIAS
            </pre>
            <p>Example: <code>sqlplus hr/hr@//localhost:1521/XEPDB1</code></p>
        </div>
    </div>
    
    <div class="card">
        <h2><i class="fas fa-user-plus"></i> Register New Candidate</h2>
        <form action="{{ url_for('candidate_register') }}" method="post" enctype="multipart/form-data">
            <div class="form-group">
                <label for="name">Full Name</label>
                <input type="text" id="name" name="name" placeholder="Enter candidate's full name" required>
            </div>
            <div class="form-group">
                <label for="party">Party</label>
                <input type="text" id="party" name="party" placeholder="Enter political party" required>
            </div>
            <div class="form-group">
                <label for="position">Position</label>
                <input type="text" id="position" name="position" placeholder="Enter position contested for" required>
            </div>
            <div class="form-group">
                <label for="bio">Biography</label>
                <textarea id="bio" name="bio" rows="4" placeholder="Brief description about the candidate"></textarea>
            </div>
            <div class="form-group">
                <label for="image">Candidate Image</label>
                <input type="file" id="image" name="image" accept="image/*">
                <small style="display: block; margin-top: 5px; color: #7f8c8d;">Recommended size: 300px Ã— 300px</small>
            </div>
            <div class="form-group">
                <button type="submit" class="btn"><i class="fas fa-save"></i> Register Candidate</button>
            </div>
        </form>
    </div>

    <div class="card">
        <h2><i class="fas fa-users"></i> Current Candidates</h2>
        <div class="candidate-list">
            {% for candidate in candidates %}
                <div class="candidate-card">
                    {% if candidate.image_path %}
                        <img src="{{ url_for('static', filename='candidate_images/' + candidate.image_path) }}" alt="{{ candidate.name }}" class="candidate-image">
                    {% else %}
                        <div style="height: 200px; background-color: #eee; display: flex; align-items: center; justify-content: center; border-radius: 5px;">
                            <i class="fas fa-user" style="font-size: 80px; color: #bbb;"></i>
                        </div>
                    {% endif %}
                    <h3>{{ candidate.name }}</h3>
                    <p><strong>Party:</strong> {{ candidate.party }}</p>
                    <p><strong>Position:</strong> {{ candidate.position }}</p>
                    {% if candidate.bio %}
                        <p>{{ candidate.bio }}</p>
                    {% endif %}
                    <div class="candidate-actions">
                        <a href="{{ url_for('edit_candidate', candidate_id=candidate.id) }}" class="btn"><i class="fas fa-edit"></i> Edit</a>
                        <a href="{{ url_for('delete_candidate', candidate_id=candidate.id) }}" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this candidate?');"><i class="fas fa-trash"></i> Delete</a>
                    </div>
                </div>
            {% else %}
                <p style="grid-column: 1 / -1; text-align: center; padding: 20px; color: #7f8c8d; font-style: italic;">
                    <i class="fas fa-info-circle"></i> No candidates registered yet.
                </p>
            {% endfor %}
        </div>
    </div>
{% endblock %}
